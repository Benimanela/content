id: DBotTrainClustering-test
version: -1
name: DBotTrainClustering-test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 8d47d645-51d6-4558-8c3c-0ee66ba1c125
    type: start
    task:
      id: 8d47d645-51d6-4558-8c3c-0ee66ba1c125
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 784232b8-1fa4-42ec-8364-e8732178eca7
    type: regular
    task:
      id: 784232b8-1fa4-42ec-8364-e8732178eca7
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
      - "6"
      - "7"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 78fa7bbb-9db5-4fec-843a-e0fb9f9dc1c2
    type: regular
    task:
      id: 78fa7bbb-9db5-4fec-843a-e0fb9f9dc1c2
      version: -1
      name: DBotTrainClustering
      description: Train clustering model on any incident type.
      scriptName: DBotTrainClustering
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      fieldForClusterName:
        simple: accountid
      fieldsForClustering:
        simple: additionaldata,sourceip
      forceRetrain:
        simple: "True"
      minNumberofIncidentPerCluster:
        simple: "3"
      modelName:
        simple: test_model
      overrideExistingModel:
        simple: "True"
      query:
        simple: (-status:closed  and sourceip:*)
      storeModel:
        simple: "True"
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: c2752ff7-c045-41ec-80fa-6685b9fec5c6
    type: title
    task:
      id: c2752ff7-c045-41ec-80fa-6685b9fec5c6
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 8eca7357-0f46-4ef0-8fb4-8f149570fb94
    type: regular
    task:
      id: 8eca7357-0f46-4ef0-8fb4-8f149570fb94
      version: -1
      name: Create incident 1
      description: commands.local.cmd.create.inc
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      accountid:
        simple: "12345"
      additionaldata:
        simple: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum
      name:
        simple: Incident 1
      sourceip:
        simple: 1.1.1.1
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 7526d5b0-a231-415b-8fe8-1da6375a155e
    type: regular
    task:
      id: 7526d5b0-a231-415b-8fe8-1da6375a155e
      version: -1
      name: Create incident 2
      description: commands.local.cmd.create.inc
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      accountid:
        simple: "12345"
      additionaldata:
        simple: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      name:
        simple: Incident 2
      sourceip:
        simple: 1.1.1.1
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: da2fa93c-0f45-43c2-841d-669dd98f4d19
    type: regular
    task:
      id: da2fa93c-0f45-43c2-841d-669dd98f4d19
      version: -1
      name: Create incident 3
      description: commands.local.cmd.create.inc
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      accountid:
        simple: "12345"
      additionaldata:
        simple: 'labore et dolore magna aliqua. '
      name:
        simple: Incident 3
      sourceip:
        simple: 1.1.1.1
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 28ce43a3-ca81-473b-8adf-2c04a3b406ff
    type: regular
    task:
      id: 28ce43a3-ca81-473b-8adf-2c04a3b406ff
      version: -1
      name: Create incident 4
      description: commands.local.cmd.create.inc
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      accountid:
        simple: "67890"
      additionaldata:
        simple: Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?
      name:
        simple: Incident 4
      sourceip:
        simple: 8.8.8.8
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 3d0b2c73-d3d0-4801-8a8c-ff149bae71b0
    type: regular
    task:
      id: 3d0b2c73-d3d0-4801-8a8c-ff149bae71b0
      version: -1
      name: Set group 1
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: group1
      value:
        simple: ${CreatedIncidentID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7f672417-ca4c-42ea-8ed4-7eadd94f055b
    type: regular
    task:
      id: 7f672417-ca4c-42ea-8ed4-7eadd94f055b
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
      - "11"
      - "12"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: a6a1999a-e64f-4d6e-842f-82643d5f8516
    type: regular
    task:
      id: a6a1999a-e64f-4d6e-842f-82643d5f8516
      version: -1
      name: Create incident 5
      description: commands.local.cmd.create.inc
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      accountid:
        simple: "67890"
      additionaldata:
        simple: m fugiat quo voluptas nulla pariatur? jhfjksdgf lkjfe hf,ds jlwd rolijrflmrwnfpj lisjfkd
      name:
        simple: Incident 5
      sourceip:
        simple: 8.8.8.8
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 66267b62-4c83-46a8-829c-37fffcdbbccc
    type: regular
    task:
      id: 66267b62-4c83-46a8-829c-37fffcdbbccc
      version: -1
      name: Create incident 6
      description: commands.local.cmd.create.inc
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      accountid:
        simple: "67890"
      additionaldata:
        simple: ' nisi ut aliquid ex ea commodi consequatur? lorem ipsum'
      name:
        simple: Incident 6
      sourceip:
        simple: 8.8.8.8
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 99abdc0d-56b4-41b0-8875-7df743b3b2b6
    type: regular
    task:
      id: 99abdc0d-56b4-41b0-8875-7df743b3b2b6
      version: -1
      name: Set group 2
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: group2
      value:
        simple: ${CreatedIncidentID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 8a68bd5c-269b-42cf-8493-67b7a32a7c23
    type: regular
    task:
      id: 8a68bd5c-269b-42cf-8493-67b7a32a7c23
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${CreatedIncidentID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 072fb1cc-cf05-4a0c-897c-d6e095595927
    type: condition
    task:
      id: 072fb1cc-cf05-4a0c-897c-d6e095595927
      version: -1
      name: Check outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DBotTrainClustering
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DBotTrainClustering.name
                      iscontext: true
                    right:
                      value:
                        simple: "12345"
                accessor: incidents_ids
                transformers:
                - operator: sort
                  args:
                    descending:
                      value:
                        simple: "true"
                - operator: StringifyArray
            iscontext: true
          right:
            value:
              complex:
                root: group1
                transformers:
                - operator: sort
                  args:
                    descending:
                      value:
                        simple: "true"
                - operator: StringifyArray
            iscontext: true
      - - operator: in
          left:
            value:
              complex:
                root: DBotTrainClustering
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DBotTrainClustering.name
                      iscontext: true
                    right:
                      value:
                        simple: "67890"
                accessor: incidents_ids
                transformers:
                - operator: sort
                  args:
                    descending:
                      value:
                        simple: "true"
                - operator: StringifyArray
            iscontext: true
          right:
            value:
              complex:
                root: group2
                transformers:
                - operator: sort
                  args:
                    descending:
                      value:
                        simple: "true"
                - operator: StringifyArray
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 09c3cf74-9d87-45bd-85da-593d97fbaec2
    type: regular
    task:
      id: 09c3cf74-9d87-45bd-85da-593d97fbaec2
      version: -1
      name: Close incidents group 1
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      id:
        simple: ${group1}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: e310cca2-93fc-4e8e-8197-6f91c722a37e
    type: regular
    task:
      id: e310cca2-93fc-4e8e-8197-6f91c722a37e
      version: -1
      name: Close incidents group 2
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      id:
        simple: ${group2}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 19cb5d6c-4c85-4f16-814a-838c21248410
    type: regular
    task:
      id: 19cb5d6c-4c85-4f16-814a-838c21248410
      version: -1
      name: DBotTrainClustering
      description: Train clustering model on any incident type.
      scriptName: DBotTrainClustering
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      fieldsForClustering:
        simple: additionaldata,sourceip
      forceRetrain:
        simple: "False"
      minNumberofIncidentPerCluster:
        simple: "1"
      modelName:
        simple: test_model
      query:
        simple: (-status:closed and sourceip:*)
      type:
        simple: Simulation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 96bf26bb-8bad-4915-8dc9-e73b449a5306
    type: regular
    task:
      id: 96bf26bb-8bad-4915-8dc9-e73b449a5306
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: d5e16968-a648-4b8a-8974-9ae455ef8564
    type: condition
    task:
      id: d5e16968-a648-4b8a-8974-9ae455ef8564
      version: -1
      name: Check outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DBotTrainClustering
                accessor: name
                transformers:
                - operator: sort
                  args:
                    descending:
                      value:
                        simple: "true"
                - operator: join
                  args:
                    separator:
                      value:
                        simple: ','
            iscontext: true
          right:
            value:
              simple: 67890,12345
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotTrainClustering.incidents_ids
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2485,
        "width": 1240,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
quiet: true
description: ''
