category: Authentication & Identity Management
description: Manage Secrets and Protect Sensitive Data through HashiCorp Vault.
commonfields:
  id: CipherTrust
  version: -1
name: CipherTrust
display: Thales CipherTrust Manager
configuration:
- display: server_url
  name: server_url
  type: 0
  required: true
- display: credentials
  name: credentials
  type: 9
  required: true
script:
  commands:
  - deprecated: false
    description: ''
    name: ciphertrust-certificate-issue
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-certificate-list
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-certificate-resume
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-certificate-revoke
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-external-certificate-delete
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-external-certificate-list
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-external-certificate-update
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-external-certificate-upload
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-group-create
    arguments:
    - name: name
      isArray: false
      description: Name of the group.
      required: true
      secret: false
      default: false
    - name: description
      isArray: false
      description: description of the group.
      required: false
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-group-delete
    arguments:
    - name: name
      isArray: false
      description: Name of the group
      required: true
      secret: false
      default: false
    - name: force
      isArray: false
      description: When set to true, groupmaps within this group will be deleted
      required: false
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-group-update
    arguments:
    - name: group_name
      isArray: false
      description: Name of the group.
      required: true
      secret: false
      default: false
    - name: description
      isArray: false
      description: description of the group.
      required: false
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: "\n    "
    name: ciphertrust-groups-list
    arguments:
    - name: group_name
      isArray: false
      description: Group name to filter by.
      required: false
      secret: false
      default: false
    - name: user_id
      isArray: false
      description: User id to filter by membership. “nil” will return groups with no members.
      required: false
      secret: false
      default: false
    - name: connection
      isArray: false
      description: Connection id or name to filter by.
      required: false
      secret: false
      default: false
    - name: client_id
      isArray: false
      description: Client id to filter by membership. “nil” will return groups with no members.
      required: false
      secret: false
      default: false
    - name: page
      isArray: false
      description: page to return.
      required: false
      secret: false
      default: false
    - name: page_size
      isArray: false
      description: number of entries per page. defaults to 2000 in case only page was provided. max is 2000
      required: false
      secret: false
      default: false
    - name: limit
      isArray: false
      description: The max number of resources to return. defaults to 50
      required: false
      secret: false
      default: false
      defaultValue: 50
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-ca-create
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-ca-delete
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-ca-install
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-ca-list
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-ca-self-sign
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-ca-update
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-local-certificate-delete
    arguments: []
    outputs: []
  - deprecated: false
    description: Tests API connectivity and authentication
    name: test_module
    arguments: []
    outputs: []
  - deprecated: false
    description: Create a new user in a domain(including root), or add an existing domain user to a sub-domain. Users are always created in the local, internal user database, but might have references to external identity providers.
    name: ciphertrust-user-create
    arguments:
    - name: name
      isArray: false
      description: User’s name
      required: false
      secret: false
      default: false
    - name: user_id
      isArray: false
      description: user_id
      required: false
      secret: false
      default: false
    - name: username
      isArray: false
      description: username
      required: false
      secret: false
      default: false
    - name: password
      isArray: false
      description: password
      required: false
      secret: false
      default: false
    - name: email
      isArray: false
      description: Users email
      required: false
      secret: false
      default: false
    - name: allowed_auth_methods
      isArray: true
      description: Filter by the loginauthentication method allowed to the users. It is a list of values. A []can bespecified to get users to whom no authentication method is allowed.
      required: false
      secret: false
      default: false
      predefined:
      - password
      - user_certificate
      - password_with_user_certificate
      - empty
      auto: PREDEFINED
    - name: allowed_client_types
      isArray: true
      description: allowed_client_types
      required: false
      secret: false
      default: false
      predefined:
      - unregistered
      - public
      - confidential
      auto: PREDEFINED
    - name: certificate_subject_dn
      isArray: false
      description: The Distinguished Name of the user in certificate
      required: false
      secret: false
      default: false
    - name: connection
      isArray: false
      description: Can be the name of a connection or "local_account" for a local user
      required: false
      secret: false
      default: false
      defaultValue: local_account
    - name: expires_at
      isArray: false
      description: The expires_at field is applicable only for local user account. Only members of the 'admin' and 'User Admins' groups can add expiration to an existing local user account or modify the expiration date. Once the expires_at date is reached, the user account gets disabled and the user is not able to perform any actions. Setting the expires_at field to empty, removes the expiration date of the user account.The supported date-time format is 2025-03-02T06:13:27.71402Z
      required: false
      secret: false
      default: false
    - name: is_domain_user
      isArray: false
      description: This flag can be used to create the user in a non-root domain where user management is allowed.
      required: false
      secret: false
      default: false
    - name: prevent_ui_login
      isArray: false
      description: 'If true, user is not allowed to login from Web UI. '
      required: false
      secret: false
      default: false
      defaultValue: 'false'
    - name: password_change_required
      isArray: false
      description: Password change required flag. If set to true, user will be required to change their password on next successful login.
      required: false
      secret: false
      default: false
    - name: password_policy
      isArray: false
      description: The password policy applies only to local user accounts and overrides the global password policy. By default, the global password policy is applied to the users.
      required: false
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-user-delete
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-user-password-change
    arguments: []
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-user-to-group-add
    arguments:
    - name: group_name
      isArray: false
      description: Name of the group.By default it will be added to the Key Users Group.
      required: true
      secret: false
      default: false
    - name: user_id
      isArray: false
      description: User id. Can be retrieved by using the command ciphertrust-users-list
      required: true
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-user-to-group-remove
    arguments:
    - name: group_name
      isArray: false
      description: Name of the group.By default it will be added to the Key Users Group.
      required: true
      secret: false
      default: false
    - name: user_id
      isArray: false
      description: User id. Can be retrieved by using the command ciphertrust-users-list
      required: true
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: Change the properties of a user. For instance the name, the password, or metadata. Permissions would normally restrict this route to users with admin privileges. Non admin users wishing to change their own passwords should use the change password route. The user will not be able to change their password to the same password.
    name: ciphertrust-user-update
    arguments:
    - name: name
      isArray: false
      description: User’s name
      required: false
      secret: false
      default: false
    - name: user_id
      isArray: false
      description: user_id
      required: true
      secret: false
      default: false
    - name: username
      isArray: false
      description: username
      required: false
      secret: false
      default: false
    - name: password
      isArray: false
      description: The password used to secure the user's account.
      required: false
      secret: false
      default: false
    - name: email
      isArray: false
      description: Users email
      required: false
      secret: false
      default: false
    - name: password_change_required
      isArray: false
      description: Password change required flag. If set to true, user will be required to change their password on next successful login.
      required: false
      secret: false
      default: false
    - name: allowed_auth_methods
      isArray: true
      description: Filter by the loginauthentication method allowed to the users. It is a list of values. A []can bespecified to get users to whom no authentication method is allowed.
      required: false
      secret: false
      default: false
      predefined:
      - password
      - user_certificate
      - password_with_user_certificate
      - empty
      auto: PREDEFINED
    - name: allowed_client_types
      isArray: true
      description: allowed_client_types
      required: false
      secret: false
      default: false
      predefined:
      - unregistered
      - public
      - confidential
      auto: PREDEFINED
    - name: certificate_subject_dn
      isArray: false
      description: The Distinguished Name of the user in certificate
      required: false
      secret: false
      default: false
    - name: expires_at
      isArray: false
      description: The expires_at field is applicable only for local user account. Only members of the 'admin' and 'User Admins' groups can add expiration to an existing local user account or modify the expiration date. Once the expires_at date is reached, the user account gets disabled and the user is not able to perform any actions. Setting the expires_at field to empty, removes the expiration date of the user account.The supported date-time format is 2025-03-02T06:13:27.71402Z
      required: false
      secret: false
      default: false
    - name: failed_logins_count
      isArray: false
      description: Set it to 0 to unlock a locked user account.
      required: false
      secret: false
      default: false
    - name: prevent_ui_login
      isArray: false
      description: If true, user is not allowed to login from Web UI.
      required: false
      secret: false
      default: false
      defaultValue: 'false'
    - name: password_policy
      isArray: false
      description: The password policy applies only to local user accounts and overrides the global password policy. By default, the global password policy is applied to the users.
      required: false
      secret: false
      default: false
    outputs: []
  - deprecated: false
    description: ''
    name: ciphertrust-users-list
    arguments:
    - name: name
      isArray: false
      description: User’s name
      required: false
      secret: false
      default: false
    - name: user_id
      isArray: false
      description: If provided, get the user with the specified id
      required: false
      secret: false
      default: false
    - name: username
      isArray: false
      description: username
      required: false
      secret: false
      default: false
    - name: email
      isArray: false
      description: User’s email
      required: false
      secret: false
      default: false
    - name: groups
      isArray: true
      description: Filter by users in the given group name. Provide multiple groups  to get users in all of those groups. Using nil as the group name will return users that are not part of any group.
      required: false
      secret: false
      default: false
    - name: exclude_groups
      isArray: true
      description: User associated with certain group will be excluded
      required: false
      secret: false
      default: false
    - name: auth_domain_name
      isArray: false
      description: Filter by user’s auth domain
      required: false
      secret: false
      default: false
    - name: account_expired
      isArray: false
      description: Filter the expired users (Boolean)
      required: false
      secret: false
      default: false
    - name: allowed_auth_methods
      isArray: true
      description: Filter by the loginauthentication method allowed to the users. It is a list of values. A []can bespecified to get users to whom no authentication method is allowed.
      required: false
      secret: false
      default: false
      predefined:
      - password
      - user_certificate
      - password_with_user_certificate
      - empty
      auto: PREDEFINED
    - name: allowed_client_types
      isArray: true
      description: allowed_client_types
      required: false
      secret: false
      default: false
      predefined:
      - unregistered
      - public
      - confidential
      auto: PREDEFINED
    - name: password_policy
      isArray: false
      description: Filter based on assigned password policy
      required: false
      secret: false
      default: false
    - name: return_groups
      isArray: false
      description: If set to ‘true’ it will return the group’s name in which user is associated, Boolean
      required: false
      secret: false
      default: false
    - name: page
      isArray: false
      description: page to return.
      required: false
      secret: false
      default: false
    - name: page_size
      isArray: false
      description: number of entries per page. defaults to 2000 in case only page was provided. max is 2000
      required: false
      secret: false
      default: false
    - name: limit
      isArray: false
      description: The max number of resources to return. defaults to 50
      required: false
      secret: false
      default: false
      defaultValue: 50
    outputs: []
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.13.86272
  feed: false
  isfetch: true
  runonce: false
  longRunning: false
  longRunningPort: false
fromversion: 6.0.0
tests:
- No tests
