category: Analytics & SIEM
commonfields:
  id: ExabeamSecOpsPlatform
  version: -1
configuration:
- defaultvalue: https://example.com/
  display: Server URL
  name: url
  required: true
  type: 0
- display: Client ID
  name: credentials
  required: true
  section: Connect
  type: 9
  displaypassword: Client Secret
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  name: first_fetch
  defaultvalue: 3 days
  type: 0
  section: Collect
  advanced: true
- display: Maximum Incidents Per Fetch
  name: max_fetch
  defaultvalue: 50
  type: 0
  section: Collect
  advanced: true
- display: Fetch query
  name: fetch_query
  type: 0
  section: Collect
  advanced: true
- display: Fetch incidents
  name: isFetch
  type: 8
- display: Incident type
  name: incidentType
  type: 13
description: Exabeam Security Operations Platform offers a centralized and scalable platform for log management.
display: Exabeam Security Operations Platform
name: ExabeamSecOpsPlatform
script:
  commands:
  - arguments:
    - defaultValue: "7 days ago"
      description: The starting date for the search range.
      name: start_time
    - defaultValue: "today"
      description: The ending date for the search range.
      name: end_time
    - defaultValue: ""
      description: Query, using Lucene syntax, filters log data for precise analysis.
      name: query
      required: false
    - description: Comma-separated list of fields to be returned from the search.
      name: fields
      required: false
      isArray: true
    - description: Comma-separated list of fields by which to group the results.
      name: group_by
      isArray: true
      required: false
    - description: The maximal number of results to return. Maximum value is 3000.
      name: limit
      required: false
    description: Get events from Exabeam Security Operations Platform.
    name: exabeam-platform-event-search
    outputs:
    - contextPath: ExabeamPlatform.Event.id
      description: The unique identifier associated with the event.
      type: String
    - contextPath: ExabeamPlatform.Event.rawLogIds
      description: The raw log identifiers associated with the event.
      type: String
    - contextPath: ExabeamPlatform.Event.tier
      description: The tier associated with the event.
      type: String
    - contextPath: ExabeamPlatform.Event.parsed
      description: Whether the event has been parsed.
      type: String
    - contextPath: ExabeamPlatform.Event.rawLogs
      description: The raw logs associated with the event.
      type: String
  - name: exabeam-platform-case-search
    description: Search for cases that match one or more search criteria. For example, you can search for cases that are associated with a specific caseId and that reference specific rules.
    arguments:
    - name: case_id
      description: An optional case id parameter to get a specific case. 
    - name: start_time
      description: Timestamp to start the search.
      defaultValue: "7 days ago"
    - name: end_time
      description: Timestamp to end the search.
      defaultValue: today
    - name: query
      description: Query, using Lucene syntax, filters log data for precise analysis.
      defaultValue: ""
    - name: fields
      description: List of fields to be returned from the search.
      isArray: true
      defaultValue: ""
    - name: order_by
      description: Order results by a specified field in ASC or DESC order, such as "riskScore ASC" or "riskScore DESC".
      isArray: true
    - name: limit
      defaultValue: 50
      description: Limit the number of results returned from the search request.
    - name: all_results
      defaultValue: No
      auto: PREDEFINED
      predefined:
      - Yes
      - No
      description: If set to 'Yes', retrieves all available results, ignoring the limit parameter.
    - name: include_related_rules
      defaultValue: No
      auto: PREDEFINED
      predefined:
      - Yes
      - No
      description: If set to 'Yes', filters the context to include the "rules" array related to the cases in the results.
    outputs:
    - contextPath: ExabeamPlatform.Case.alertId
      description: Unique identifier for the alert associated with the case.
      type: String
    - contextPath: ExabeamPlatform.Case.alertName
      description: Name of the alert associated with the case.
      type: String
    - contextPath: ExabeamPlatform.Case.approxLogTime
      description: Approximate log time of the event that generated the case.
      type: Number
    - contextPath: ExabeamPlatform.Case.assignee
      description: User assigned to the case.
      type: String
    - contextPath: ExabeamPlatform.Case.caseCreationTimestamp
      description: Timestamp when the case was created.
      type: Number
    - contextPath: ExabeamPlatform.Case.caseId
      description: Unique identifier for the case.
      type: String
    - contextPath: ExabeamPlatform.Case.destHosts
      description: Destination hosts involved in the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.destIps
      description: Destination IP addresses involved in the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.groupedbyKey
      description: Key by which the case was grouped.
      type: String
    - contextPath: ExabeamPlatform.Case.groupedbyValue
      description: Value by which the case was grouped.
      type: String
    - contextPath: ExabeamPlatform.Case.hasAttachments
      description: Indicates if the case has attachments.
      type: Boolean
    - contextPath: ExabeamPlatform.Case.ingestTimestamp
      description: Timestamp when the case was ingested.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.lastModifiedTimestamp
      description: Timestamp when the case was last modified.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.mitres
      description: MITRE tactics and techniques associated with the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.priority
      description: Priority level of the case.
      type: String
    - contextPath: ExabeamPlatform.Case.products
      description: Products involved in the case.
      type: String
    - contextPath: ExabeamPlatform.Case.queue
      description: Queue to which the case is assigned.
      type: String
    - contextPath: ExabeamPlatform.Case.riskScore
      description: Risk score of the case.
      type: Number
    - contextPath: ExabeamPlatform.Case.rules.approxLogTime
      description: Approximate log time of the rule that triggered the case.
      type: Number
    - contextPath: ExabeamPlatform.Case.rules.ruleId
      description: Unique identifier for the rule.
      type: String
    - contextPath: ExabeamPlatform.Case.rules.ruleName
      description: Name of the rule that triggered the case.
      type: String
    - contextPath: ExabeamPlatform.Case.rules.ruleReason
      description: Reason for the rule triggering the case.
      type: String
    - contextPath: ExabeamPlatform.Case.rules.ruleSeverity
      description: Severity level of the rule.
      type: String
    - contextPath: ExabeamPlatform.Case.rules.ruleSource
      description: Source of the rule.
      type: String
    - contextPath: ExabeamPlatform.Case.rules.ruleType
      description: Type of the rule.
      type: String
    - contextPath: ExabeamPlatform.Case.srcHosts
      description: Source hosts involved in the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.srcIps
      description: Source IP addresses involved in the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.stage
      description: Current stage of the case.
      type: String
    - contextPath: ExabeamPlatform.Case.subscriptionCode
      description: Subscription code associated with the case.
      type: String
    - contextPath: ExabeamPlatform.Case.tags
      description: Tags associated with the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.useCases
      description: Use cases associated with the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.users
      description: Users involved in the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.vendors
      description: Vendors involved in the case.
      type: String
    - contextPath: ExabeamPlatform.Case.alertCreationTimestamp
      description: Timestamp when the alert was created.
      type: Date
    - contextPath: ExabeamPlatform.Case.alertDescriptionRt
      description: Description of the alert.
      type: String
    - contextPath: ExabeamPlatform.Case.creationBy
      description: User who created the case.
      type: String
    - contextPath: ExabeamPlatform.Case.creationTimestamp
      description: Timestamp when the case was created.
      type: Date
    - contextPath: ExabeamPlatform.Case.destEndpoints
      description: Destination endpoints involved in the case.
      type: Unknown
    - contextPath: ExabeamPlatform.Case.mitres.tacticKey
      description: Key of the MITRE tactic associated with the case.
      type: String
    - contextPath: ExabeamPlatform.Case.mitres.technique
      description: MITRE technique associated with the case.
      type: String
    - contextPath: ExabeamPlatform.Case.mitres.techniqueKey
      description: Key of the MITRE technique associated with the case.
      type: String
  - name: exabeam-platform-alert-search
    description: Search for alerts that match one or more search criteria.
    arguments:
    - name: alert_id
      description: Unique ID that identifies an alert. 
    - name: start_time
      description: Timestamp to start the search.
      defaultValue: "7 days ago"
    - name: end_time
      description: Timestamp to end the search.
      defaultValue: today
    - name: query
      description: Query, using Lucene syntax, filters log data for precise analysis.
      defaultValue: ""
    - name: fields
      description: List of fields to be returned from the search.
      isArray: true
      defaultValue: ""
    - name: order_by
      description: Order results by a specified field in ASC or DESC order, such as "riskScore ASC" or "riskScore DESC".
      isArray: true
    - name: limit
      defaultValue: 50
      description: Limit the number of results returned from the search request.
    - name: all_results
      defaultValue: No
      auto: PREDEFINED
      predefined:
      - Yes
      - No
      description: If set to 'Yes', retrieves all available results, ignoring the limit parameter.
    - name: include_related_rules
      defaultValue: No
      auto: PREDEFINED
      predefined:
      - Yes
      - No
      description: If set to 'Yes', filters the context to include the "rules" array related to the cases in the results.
    outputs:  
  - name: exabeam-platform-context-table-list
    description: Retrieve metadata for all existing context tables, including source, operational status, and attribute mapping.
    arguments:
    - name: table_id
      description: Specify the ID of an existing context table
    - name: limit
      defaultValue: 50
      description: Limit the number of results returned from the request.
    - name: include_attributes
      description: If set to 'Yes', filters the context to include the "attributes" array related to the cases in the results.
      defaultValue: No
      auto: PREDEFINED
      predefined:
      - Yes
      - No
    outputs:  
  - name: exabeam-platform-context-table-delete
    description: Delete a specific context table, including records and attributes.
    arguments:
    - name: table_id
      description: Specify the ID of an existing context table.
      required: true
    - name: delete_unused_custom_attributes
      description: Delete any custom attributes in this table that are not used in another context table.
      defaultValue: No
      auto: PREDEFINED
      predefined:
      - Yes
      - No 
  - name: exabeam-platform-table-record-list
    description: Retrieve the records for a specific context table.
    arguments:
    - name: table_id
      description: ID of the table. Obtain this value by running `exabeam-platform-context-table-list`.
      required: true
    - name: limit
      description: The number of records to return.
      defaultValue: 50
  runonce: false
  script: '-'
  type: python
  isfetch: true
  subtype: python3
  dockerimage: demisto/python3:3.10.14.95956
fromversion: 6.10.0
tests:
- ExabeamSecurityOperationsPlatform-test
