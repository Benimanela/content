args:
- name: username
  required: true
comment: CTF Script that initiates a revoke for all user's access keys.
commonfields:
  id: APIKeyRevokeCTF
  version: -1
dockerimage: demisto/python3:3.10.12.63474
enabled: true
name: APIKeyRevokeCTF
runas: DBotWeakRole
runonce: false
script: |
  import secrets


  def validate(username):
      if (username.lower() == "svc_dev"):
          return "You got it right.Removed previous access keys to this user.\nFlag: keepcalmandstaysecure"
      else:
          string="You got it wrong, the attacker still has an access to the organization.\nFlag:"
          flag =  secrets.token_hex(21)
          return string + " " + flag



  def main():
      args = demisto.args()
      username = args.get('username')
      try:
          return_results(validate(username))
      except Exception as ex:
          return_error(f'Failed to execute APIKeyRevokeCTF. Error: {str(ex)}')


  if __name__ in ('__main__', '__builtin__', 'builtins'):
      main()
scripttarget: 0
subtype: python3
tags: []
type: python
fromversion: 6.9.0
tests:
- No tests (auto formatted)
